<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/hierarchidb/favicon.svg" />
    <title>HierarchiDB</title>
    <script type="text/javascript">
      // Hash routing handler for GitHub Pages
      // Convert path-based URLs to hash-based URLs - run only once on page load
      (function() {
        // Check if we already processed this page
        if (sessionStorage.getItem('hash-routing-processed')) {
          return;
        }
        
        var path = window.location.pathname;
        var base = '/hierarchidb';
        
        // Only redirect if we're on a sub-path (not the root)
        // and we don't already have a hash fragment
        if (path !== base + '/' && path.startsWith(base + '/') && !window.location.hash) {
          sessionStorage.setItem('hash-routing-processed', 'true');
          var hashPath = path.substring(base.length);
          window.location.replace(base + '/#' + hashPath + window.location.search);
        } else if (path === base + '/') {
          // Mark as processed for root path too
          sessionStorage.setItem('hash-routing-processed', 'true');
        }
      })();
    </script>
</head>
<body>
<div id="root"></div>
<script>
  // React Router SPA mode initialization with hash routing support
  window.__reactRouterContext = {
    "basename": "/hierarchidb/",
    "future": {
      "unstable_middleware": false,
      "unstable_optimizeDeps": false,
      "unstable_splitRouteModules": false,
      "unstable_subResourceIntegrity": false,
      "unstable_viteEnvironmentApi": false
    },
    "routeDiscovery": {"mode": "initial"},
    "ssr": false,
    "isSpaMode": true
  };
  
  // Intercept navigation to add hash prefix - disabled for now to prevent loops
  // This approach can cause conflicts with React Router's internal navigation
  /*
  var originalPushState = history.pushState;
  var originalReplaceState = history.replaceState;
  
  history.pushState = function() {
    var url = arguments[2];
    if (url && !url.startsWith('#') && !url.startsWith('/hierarchidb/#')) {
      arguments[2] = '/hierarchidb/#' + url.replace('/hierarchidb', '');
    }
    return originalPushState.apply(history, arguments);
  };
  
  history.replaceState = function() {
    var url = arguments[2];
    if (url && !url.startsWith('#') && !url.startsWith('/hierarchidb/#')) {
      arguments[2] = '/hierarchidb/#' + url.replace('/hierarchidb', '');
    }
    return originalReplaceState.apply(history, arguments);
  };
  */
  
  // Create a minimal stream for SPA mode
  window.__reactRouterContext.stream = new ReadableStream({
    start(controller) {
      window.__reactRouterContext.streamController = controller;
      controller.enqueue('[{"_1":2,"_3":-5,"_4":-5},"loaderData",{},"actionData","errors"]' + String.fromCharCode(10));
      controller.close();
    }
  }).pipeThrough(new TextEncoderStream());
</script>
<script type="module">
  import "/hierarchidb/assets/manifest-2f89e474.js";
  import * as route0 from "/hierarchidb/assets/root.js";
  import * as indexRoute from "/hierarchidb/assets/_index.js";
  
  window.__reactRouterRouteModules = {
    "root": route0,
    "routes/_index": indexRoute
  };
  
  import("/hierarchidb/assets/entry.client.js");
</script>
</body>
</html>