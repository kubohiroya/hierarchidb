import{w as h,u as p,a as f,r as s}from"./vendor-react-BP9jdMJE.js";import{j as r}from"./jsx-runtime-D_zvdyIk.js";import{A as d}from"./index-LrBs_WFz.js";import{B as c,T as l,C as x}from"./Box-zDrc8-aq.js";import{A as g}from"./Alert-C-Br81AU.js";import"./assertThisInitialized-C6AqJUPC.js";import"./TransitionGroup-wYxCXXF3.js";import"./createSimplePaletteValueFilter-BuD9q6B8.js";import"./useSlot-Cr8mcnhD.js";import"./IconButton-DRvuffCM.js";import"./Paper-hI1Q5KHP.js";const S=h(function(){const a=p(),[e]=f(),[n,m]=s.useState(null);return s.useEffect(()=>{async function o(){try{const t=e.get("code"),i=e.get("error");if(i)throw new Error(`Authentication error: ${i}`);if(!t)throw new Error("No authorization code received");await d.handleCallback();const u=sessionStorage.getItem("auth.returnUrl")||"/";sessionStorage.removeItem("auth.returnUrl"),a(u,{replace:!0})}catch(t){console.error("Auth callback error:",t),m(t instanceof Error?t.message:"Authentication failed")}}o()},[e,a]),s.useEffect(()=>{if(window.opener){const o=Object.fromEntries(e.entries());window.opener.postMessage({type:"auth-callback",params:o},window.location.origin),window.close()}},[e]),n?r.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",p:3},children:[r.jsx(g,{severity:"error",sx:{mb:2},children:n}),r.jsx(l,{children:r.jsx("a",{href:"/",children:"Return to Home"})})]}):r.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:[r.jsx(x,{size:60}),r.jsx(l,{variant:"h6",sx:{mt:3},children:"Completing authentication..."})]})});export{S as default};
