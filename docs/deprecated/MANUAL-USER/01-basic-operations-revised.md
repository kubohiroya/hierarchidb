# 基本操作ガイド（実装済み機能）

## 現在利用可能な機能

HierarchiDBの現バージョンで実際に利用可能な機能を説明します。

## TreeConsole - 階層データ管理

### 画面構成
アプリケーションのメイン画面はTreeConsoleコンポーネントで構成されています：

```
┌─────────────────────────────────────────────────────┐
│  パンくずリスト: Root > Folder1 > Current Location  │
├─────────────────────────────────────────────────────┤
│  ツールバー: [検索] [更新] [展開] [折りたたみ]      │
├─────────────────────────────────────────────────────┤
│  TreeTableView（階層ツリー表示）                    │
│  ▼ Root                                            │
│    ▼ Folder1                                       │
│      ・Item 1                                      │
│      ・Item 2                                      │
│    ▶ Folder2                                       │
│    🗑️ Trash                                        │
├─────────────────────────────────────────────────────┤
│  フッター: 2 items selected | 10 total             │
└─────────────────────────────────────────────────────┘
```

### 実装済みの基本操作

#### 1. ノードの作成
- **フォルダ作成**: SpeedDialボタン（右下の+ボタン）から「Create Folder」を選択
- **各種ノード作成**: BaseMap、StyleMap、Shape、Spreadsheetノードの作成が可能（ただし、各プラグインの実装は限定的）

#### 2. ツリーの操作
- **展開/折りたたみ**: フォルダ左の矢印アイコンをクリック
- **全展開**: ツールバーの「展開」ボタン
- **全折りたたみ**: ツールバーの「折りたたみ」ボタン

#### 3. 検索機能
- ツールバーの検索ボックスにキーワードを入力
- リアルタイムでツリー内を検索

#### 4. 選択操作
- 単一選択: ノードをクリック
- 複数選択: Ctrlキーを押しながらクリック（実装状況要確認）

#### 5. ゴミ箱機能
- ノードをゴミ箱に移動（ソフト削除）
- ゴミ箱からの復元

## Worker API - データ永続化

### データベース構造
アプリケーションは以下の2つのデータベースを使用：

1. **CoreDB**: 永続データの保存
   - TreeNode（階層構造）
   - Tree（ツリーメタデータ）
   - プラグインエンティティ

2. **EphemeralDB**: 一時データの保存
   - WorkingCopy（編集中データ）
   - セッション情報

### 自動保存
- 編集内容は自動的にIndexedDBに保存
- ブラウザを閉じても次回アクセス時にデータは保持される

## プラグインの実装状況

### BaseMapプラグイン
**実装済み:**
- 基本的な地図表示（MapLibre GL使用）
- 地図スタイルの設定（OSM、地理院地図など）
- 中心座標とズームレベルの設定
- ベアリング（回転）とピッチ（傾き）の設定

**未実装:**
- 測定機能
- レイヤー管理
- 高度な地図分析

### StyleMapプラグイン
**実装済み:**
- 基本的なエンティティ構造
- ノードタイプの登録

**未実装:**
- スタイル設定UI
- 実際のスタイル適用機能

### Shapeプラグイン
**実装済み:**
- エンティティ構造の定義
- バッチ処理の基盤（一部）

**未実装:**
- 実際の地理データ処理
- UI実装

### Spreadsheetプラグイン
**実装済み:**
- エンティティハンドラー
- 基本的なメタデータ構造
- 参照カウント管理

**未実装:**
- 表計算UI
- CSVインポート/エクスポート
- 計算式機能

## 制限事項と注意点

### 現在の制限
1. **UI未実装**: 多くのプラグインでUIコンポーネントが未実装
2. **機能制限**: ドキュメントに記載されている高度な機能の多くは未実装
3. **デモ段階**: treeconsole-simple、treeconsole-demoルートでの基本動作確認が主

### 開発中の機能
- プラグインUIの完全実装
- Import/Export機能
- 高度な検索・フィルタリング
- リアルタイムコラボレーション

## トラブルシューティング

### よくある問題

**Worker初期化エラー**
- ブラウザがWeb Worker対応か確認
- IndexedDBが有効か確認
- ブラウザのプライベートモードでないか確認

**データが表示されない**
- ブラウザコンソールでエラーを確認
- IndexedDBのデータを確認（開発者ツール > Application > IndexedDB）

**プラグイン機能が動作しない**
- 該当機能が実装済みか上記リストで確認
- 多くの機能はまだ開発中です

## 開発者向け情報

実装の詳細やコードについては以下を参照：
- ソースコード: `/packages/`ディレクトリ
- 開発レポート: `/docs/REPORT/`
- API仕様: `/docs/MANUAL/`